train_master_interaction = {
    category = interaction_category_vassal
    icon = "gfx/interface/icons/council_task_types/task_manage_guards.dds"
    
    is_shown = {
        scope:actor = { is_ruler = yes }
        scope:recipient = {
            is_courtier_of = scope:actor
            is_adult = yes
            is_manorial_lord = no
            is_knight = no
            is_landed = no
            # Only for "Masters" (Sons of Knights/Manorial Lords)
            OR = {
                father = {
                    OR = {
                        has_trait = trait_dubbed_knight
                        is_manorial_lord = yes
                    }
                }
                mother = {
                    OR = {
                        has_trait = trait_dubbed_knight
                        is_manorial_lord = yes
                    }
                }
            }
        }
    }

    is_valid_showing_failures_only = {
        scope:actor = { gold >= 50 }
        scope:recipient = {
            is_imprisoned = no
            NOT = { has_character_flag = received_training_flag }
        }
    }

    on_accept = {
        scope:actor = { remove_short_term_gold = 50 }
        scope:recipient = {
            random_list = {
                70 = { 
                    add_prowess_skill = 2 
                    send_interface_toast = { title = "Training Complete" left_icon = scope:recipient custom_tooltip = "msg_training_prowess" }
                }
                # INTEGRATION: Chance to become "Gentry" (Mod 3361162762)
                30 = {
                    trigger = {
                        # Only if they don't already have it
                        NOT = { has_trait = gentry } 
                    }
                    add_trait = gentry
                    add_prowess_skill = 1
                    send_interface_toast = { 
                        title = "Recognized as Gentry" 
                        left_icon = scope:recipient 
                        custom_tooltip = "msg_training_gentry" 
                    }
                }
            }
        }
    }
    auto_accept = yes
}

